  0%|                                                                                                                                                             | 0/1000 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
                                                                                                                                                                                           
{'loss': 3.5055, 'grad_norm': 3.1302781105041504, 'learning_rate': 9e-06, 'epoch': 1.0}
{'loss': 3.2815, 'grad_norm': 2.5605416297912598, 'learning_rate': 1.9e-05, 'epoch': 2.0}
{'loss': 2.8845, 'grad_norm': 2.0486667156219482, 'learning_rate': 2.9e-05, 'epoch': 3.0}
{'loss': 2.3921, 'grad_norm': 2.3488693237304688, 'learning_rate': 3.9000000000000006e-05, 'epoch': 4.0}
{'loss': 2.0057, 'grad_norm': 0.7954354286193848, 'learning_rate': 4.9e-05, 'epoch': 5.0}
{'loss': 1.807, 'grad_norm': 0.7517842054367065, 'learning_rate': 5.9e-05, 'epoch': 6.0}
{'loss': 1.6562, 'grad_norm': 0.5891876220703125, 'learning_rate': 6.9e-05, 'epoch': 7.0}
{'loss': 1.5329, 'grad_norm': 0.5967914462089539, 'learning_rate': 7.900000000000001e-05, 'epoch': 8.0}
{'loss': 1.425, 'grad_norm': 0.7296590805053711, 'learning_rate': 8.900000000000001e-05, 'epoch': 9.0}
{'loss': 1.3328, 'grad_norm': 0.7456168532371521, 'learning_rate': 9.900000000000001e-05, 'epoch': 10.0}
{'loss': 1.246, 'grad_norm': 0.9510619044303894, 'learning_rate': 9.900000000000001e-05, 'epoch': 11.0}
{'loss': 1.1626, 'grad_norm': 0.8242520689964294, 'learning_rate': 9.78888888888889e-05, 'epoch': 12.0}
{'loss': 1.0811, 'grad_norm': 0.9277897477149963, 'learning_rate': 9.677777777777778e-05, 'epoch': 13.0}
{'loss': 1.0006, 'grad_norm': 0.9614847898483276, 'learning_rate': 9.566666666666667e-05, 'epoch': 14.0}
{'loss': 0.9241, 'grad_norm': 1.3691474199295044, 'learning_rate': 9.455555555555556e-05, 'epoch': 15.0}
{'loss': 0.8441, 'grad_norm': 1.190943956375122, 'learning_rate': 9.344444444444444e-05, 'epoch': 16.0}
{'loss': 0.7671, 'grad_norm': 1.2816822528839111, 'learning_rate': 9.233333333333333e-05, 'epoch': 17.0}
{'loss': 0.7008, 'grad_norm': 1.54604172706604, 'learning_rate': 9.122222222222223e-05, 'epoch': 18.0}
{'loss': 0.636, 'grad_norm': 1.5805308818817139, 'learning_rate': 9.011111111111111e-05, 'epoch': 19.0}
{'loss': 0.58, 'grad_norm': 1.82216477394104, 'learning_rate': 8.900000000000001e-05, 'epoch': 20.0}
{'loss': 0.5295, 'grad_norm': 1.769650936126709, 'learning_rate': 8.78888888888889e-05, 'epoch': 21.0}
{'loss': 0.4825, 'grad_norm': 1.7202930450439453, 'learning_rate': 8.677777777777778e-05, 'epoch': 22.0}
{'loss': 0.4427, 'grad_norm': 1.710567593574524, 'learning_rate': 8.566666666666667e-05, 'epoch': 23.0}
{'loss': 0.407, 'grad_norm': 1.6392754316329956, 'learning_rate': 8.455555555555556e-05, 'epoch': 24.0}
{'loss': 0.3761, 'grad_norm': 1.681570291519165, 'learning_rate': 8.344444444444445e-05, 'epoch': 25.0}
{'loss': 0.3503, 'grad_norm': 1.6193389892578125, 'learning_rate': 8.233333333333333e-05, 'epoch': 26.0}
{'loss': 0.3286, 'grad_norm': 1.8772028684616089, 'learning_rate': 8.122222222222222e-05, 'epoch': 27.0}
{'loss': 0.3107, 'grad_norm': 1.6714907884597778, 'learning_rate': 8.011111111111111e-05, 'epoch': 28.0}
{'loss': 0.2936, 'grad_norm': 1.916368007659912, 'learning_rate': 7.900000000000001e-05, 'epoch': 29.0}
{'loss': 0.281, 'grad_norm': 1.5782190561294556, 'learning_rate': 7.788888888888888e-05, 'epoch': 30.0}
{'loss': 0.2685, 'grad_norm': 1.4388208389282227, 'learning_rate': 7.677777777777778e-05, 'epoch': 31.0}
{'loss': 0.26, 'grad_norm': 1.2621326446533203, 'learning_rate': 7.566666666666667e-05, 'epoch': 32.0}
{'loss': 0.2505, 'grad_norm': 1.2113802433013916, 'learning_rate': 7.455555555555556e-05, 'epoch': 33.0}
{'loss': 0.2453, 'grad_norm': 1.3604954481124878, 'learning_rate': 7.344444444444445e-05, 'epoch': 34.0}
{'loss': 0.2399, 'grad_norm': 1.2567739486694336, 'learning_rate': 7.233333333333335e-05, 'epoch': 35.0}
{'loss': 0.2355, 'grad_norm': 1.2767659425735474, 'learning_rate': 7.122222222222222e-05, 'epoch': 36.0}
{'loss': 0.2319, 'grad_norm': 1.290108323097229, 'learning_rate': 7.011111111111112e-05, 'epoch': 37.0}
{'loss': 0.2281, 'grad_norm': 1.3030954599380493, 'learning_rate': 6.9e-05, 'epoch': 38.0}
{'loss': 0.2246, 'grad_norm': 1.0934895277023315, 'learning_rate': 6.788888888888888e-05, 'epoch': 39.0}
{'loss': 0.2214, 'grad_norm': 1.1283667087554932, 'learning_rate': 6.677777777777779e-05, 'epoch': 40.0}
{'loss': 0.2195, 'grad_norm': 0.8218105435371399, 'learning_rate': 6.566666666666666e-05, 'epoch': 41.0}
{'loss': 0.2169, 'grad_norm': 0.6955041885375977, 'learning_rate': 6.455555555555556e-05, 'epoch': 42.0}
{'loss': 0.214, 'grad_norm': 0.6955875754356384, 'learning_rate': 6.344444444444445e-05, 'epoch': 43.0}
{'loss': 0.2123, 'grad_norm': 0.6844933032989502, 'learning_rate': 6.233333333333334e-05, 'epoch': 44.0}
{'loss': 0.2102, 'grad_norm': 0.6555180549621582, 'learning_rate': 6.122222222222222e-05, 'epoch': 45.0}
{'loss': 0.2094, 'grad_norm': 0.5669667720794678, 'learning_rate': 6.011111111111112e-05, 'epoch': 46.0}
{'loss': 0.2079, 'grad_norm': 0.48279163241386414, 'learning_rate': 5.9e-05, 'epoch': 47.0}
{'loss': 0.2063, 'grad_norm': 0.5037686228752136, 'learning_rate': 5.788888888888889e-05, 'epoch': 48.0}
{'loss': 0.2063, 'grad_norm': 0.5418316125869751, 'learning_rate': 5.6777777777777786e-05, 'epoch': 49.0}
{'loss': 0.2059, 'grad_norm': 0.4814402461051941, 'learning_rate': 5.566666666666667e-05, 'epoch': 50.0}
{'loss': 0.2051, 'grad_norm': 0.529764711856842, 'learning_rate': 5.455555555555556e-05, 'epoch': 51.0}
{'loss': 0.2042, 'grad_norm': 0.46074140071868896, 'learning_rate': 5.3444444444444455e-05, 'epoch': 52.0}
{'loss': 0.2038, 'grad_norm': 0.5063498020172119, 'learning_rate': 5.2333333333333336e-05, 'epoch': 53.0}
{'loss': 0.2029, 'grad_norm': 0.4899161159992218, 'learning_rate': 5.122222222222223e-05, 'epoch': 54.0}
{'loss': 0.2024, 'grad_norm': 0.5443471670150757, 'learning_rate': 5.011111111111111e-05, 'epoch': 55.0}
{'loss': 0.2023, 'grad_norm': 0.4651431143283844, 'learning_rate': 4.9e-05, 'epoch': 56.0}
{'loss': 0.2014, 'grad_norm': 1.0401701927185059, 'learning_rate': 4.7888888888888886e-05, 'epoch': 57.0}
{'loss': 0.202, 'grad_norm': 0.6310601830482483, 'learning_rate': 4.677777777777778e-05, 'epoch': 58.0}
{'loss': 0.2017, 'grad_norm': 0.6513147354125977, 'learning_rate': 4.566666666666667e-05, 'epoch': 59.0}
{'loss': 0.2015, 'grad_norm': 0.44635656476020813, 'learning_rate': 4.4555555555555555e-05, 'epoch': 60.0}
{'loss': 0.201, 'grad_norm': 0.7347199320793152, 'learning_rate': 4.344444444444445e-05, 'epoch': 61.0}
{'loss': 0.2002, 'grad_norm': 0.510211706161499, 'learning_rate': 4.233333333333334e-05, 'epoch': 62.0}
{'loss': 0.1999, 'grad_norm': 0.39614853262901306, 'learning_rate': 4.1222222222222224e-05, 'epoch': 63.0}
{'loss': 0.1996, 'grad_norm': 0.5507075190544128, 'learning_rate': 4.011111111111111e-05, 'epoch': 64.0}
{'loss': 0.1988, 'grad_norm': 0.4262303411960602, 'learning_rate': 3.9000000000000006e-05, 'epoch': 65.0}
{'loss': 0.1989, 'grad_norm': 0.4707462787628174, 'learning_rate': 3.7888888888888894e-05, 'epoch': 66.0}
{'loss': 0.1985, 'grad_norm': 0.4500507116317749, 'learning_rate': 3.677777777777778e-05, 'epoch': 67.0}
{'loss': 0.1981, 'grad_norm': 0.3665076792240143, 'learning_rate': 3.566666666666667e-05, 'epoch': 68.0}
{'loss': 0.1981, 'grad_norm': 0.41121339797973633, 'learning_rate': 3.4555555555555556e-05, 'epoch': 69.0}
{'loss': 0.1978, 'grad_norm': 0.4202638268470764, 'learning_rate': 3.3444444444444443e-05, 'epoch': 70.0}
{'loss': 0.1978, 'grad_norm': 0.37700021266937256, 'learning_rate': 3.233333333333333e-05, 'epoch': 71.0}
{'loss': 0.1973, 'grad_norm': 0.35462382435798645, 'learning_rate': 3.1222222222222225e-05, 'epoch': 72.0}
{'loss': 0.1969, 'grad_norm': 0.38055336475372314, 'learning_rate': 3.0111111111111113e-05, 'epoch': 73.0}
{'loss': 0.1971, 'grad_norm': 0.4542001783847809, 'learning_rate': 2.9e-05, 'epoch': 74.0}
{'loss': 0.1969, 'grad_norm': 0.4662553668022156, 'learning_rate': 2.788888888888889e-05, 'epoch': 75.0}
{'loss': 0.1965, 'grad_norm': 0.41472095251083374, 'learning_rate': 2.677777777777778e-05, 'epoch': 76.0}
{'loss': 0.1968, 'grad_norm': 0.3834459185600281, 'learning_rate': 2.5666666666666666e-05, 'epoch': 77.0}
{'loss': 0.1963, 'grad_norm': 0.41517174243927, 'learning_rate': 2.4555555555555557e-05, 'epoch': 78.0}
{'loss': 0.1968, 'grad_norm': 0.45330676436424255, 'learning_rate': 2.3444444444444448e-05, 'epoch': 79.0}
{'loss': 0.1963, 'grad_norm': 0.3944714069366455, 'learning_rate': 2.2333333333333335e-05, 'epoch': 80.0}
{'loss': 0.1961, 'grad_norm': 0.4868670701980591, 'learning_rate': 2.1222222222222223e-05, 'epoch': 81.0}
{'loss': 0.1963, 'grad_norm': 0.39516085386276245, 'learning_rate': 2.011111111111111e-05, 'epoch': 82.0}
{'loss': 0.1958, 'grad_norm': 0.36284443736076355, 'learning_rate': 1.9e-05, 'epoch': 83.0}
{'loss': 0.1959, 'grad_norm': 0.37380725145339966, 'learning_rate': 1.788888888888889e-05, 'epoch': 84.0}
{'loss': 0.1955, 'grad_norm': 0.39642810821533203, 'learning_rate': 1.677777777777778e-05, 'epoch': 85.0}
{'loss': 0.1953, 'grad_norm': 0.3855130970478058, 'learning_rate': 1.5666666666666667e-05, 'epoch': 86.0}
{'loss': 0.1953, 'grad_norm': 0.35205212235450745, 'learning_rate': 1.4555555555555556e-05, 'epoch': 87.0}
{'loss': 0.1954, 'grad_norm': 0.5846797823905945, 'learning_rate': 1.3444444444444445e-05, 'epoch': 88.0}
{'loss': 0.1952, 'grad_norm': 0.3372562527656555, 'learning_rate': 1.2333333333333334e-05, 'epoch': 89.0}
{'loss': 0.195, 'grad_norm': 0.4030212461948395, 'learning_rate': 1.1222222222222224e-05, 'epoch': 90.0}
{'loss': 0.1947, 'grad_norm': 0.34988826513290405, 'learning_rate': 1.0111111111111111e-05, 'epoch': 91.0}
{'loss': 0.1952, 'grad_norm': 0.377460241317749, 'learning_rate': 9e-06, 'epoch': 92.0}
{'loss': 0.1946, 'grad_norm': 0.306851327419281, 'learning_rate': 7.88888888888889e-06, 'epoch': 93.0}
{'loss': 0.1945, 'grad_norm': 0.34180983901023865, 'learning_rate': 6.777777777777779e-06, 'epoch': 94.0}
{'loss': 0.1947, 'grad_norm': 0.3294907808303833, 'learning_rate': 5.666666666666667e-06, 'epoch': 95.0}
{'loss': 0.1945, 'grad_norm': 0.36053016781806946, 'learning_rate': 4.555555555555556e-06, 'epoch': 96.0}
{'loss': 0.1946, 'grad_norm': 0.3531077206134796, 'learning_rate': 3.4444444444444444e-06, 'epoch': 97.0}
{'loss': 0.1945, 'grad_norm': 0.337313711643219, 'learning_rate': 2.3333333333333336e-06, 'epoch': 98.0}
{'loss': 0.1943, 'grad_norm': 0.30535265803337097, 'learning_rate': 1.2222222222222223e-06, 'epoch': 99.0}
{'loss': 0.1943, 'grad_norm': 0.3147274851799011, 'learning_rate': 1.1111111111111112e-07, 'epoch': 100.0}
{'train_runtime': 4536.9727, 'train_samples_per_second': 26.846, 'train_steps_per_second': 0.22, 'train_loss': 0.48970656645298005, 'epoch': 100.0}
Saving model to ./qwen_law_assistant...
Fine-tuning completed!
Fine-tuning completed! Model saved to: ./qwen_law_assistant

=== Pipeline completed! ===
