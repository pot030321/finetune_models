  0%|                                                                                                                                                             | 0/1530 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
                                                                                                                                                                                           
{'loss': 3.6766, 'grad_norm': 4.360418796539307, 'learning_rate': 9e-06, 'epoch': 0.07}
{'loss': 3.4581, 'grad_norm': 2.8120274543762207, 'learning_rate': 1.9e-05, 'epoch': 0.13}
{'loss': 3.1718, 'grad_norm': 3.1051018238067627, 'learning_rate': 2.9e-05, 'epoch': 0.2}
{'loss': 2.8361, 'grad_norm': 3.0414810180664062, 'learning_rate': 3.9000000000000006e-05, 'epoch': 0.26}
{'loss': 2.4561, 'grad_norm': 2.115225076675415, 'learning_rate': 4.9e-05, 'epoch': 0.33}
{'loss': 2.2252, 'grad_norm': 2.114248275756836, 'learning_rate': 5.9e-05, 'epoch': 0.39}
{'loss': 2.1808, 'grad_norm': 1.8557525873184204, 'learning_rate': 6.9e-05, 'epoch': 0.46}
{'loss': 2.0984, 'grad_norm': 1.9290388822555542, 'learning_rate': 7.900000000000001e-05, 'epoch': 0.53}
{'loss': 1.996, 'grad_norm': 2.1547908782958984, 'learning_rate': 8.900000000000001e-05, 'epoch': 0.59}
{'loss': 1.8836, 'grad_norm': 2.153319835662842, 'learning_rate': 9.900000000000001e-05, 'epoch': 0.66}
{'loss': 1.8464, 'grad_norm': 2.8519821166992188, 'learning_rate': 9.937062937062938e-05, 'epoch': 0.72}
{'loss': 1.7656, 'grad_norm': 2.308305501937866, 'learning_rate': 9.867132867132868e-05, 'epoch': 0.79}
{'loss': 1.7454, 'grad_norm': 2.359501361846924, 'learning_rate': 9.797202797202798e-05, 'epoch': 0.85}
{'loss': 1.7197, 'grad_norm': 2.0247747898101807, 'learning_rate': 9.727272727272728e-05, 'epoch': 0.92}
{'loss': 1.6694, 'grad_norm': 2.064303398132324, 'learning_rate': 9.657342657342658e-05, 'epoch': 0.99}
{'loss': 1.6449, 'grad_norm': 2.3528342247009277, 'learning_rate': 9.587412587412587e-05, 'epoch': 1.05}
{'loss': 1.5219, 'grad_norm': 1.8938555717468262, 'learning_rate': 9.517482517482518e-05, 'epoch': 1.11}
{'loss': 1.5812, 'grad_norm': 2.1795506477355957, 'learning_rate': 9.447552447552449e-05, 'epoch': 1.18}
{'loss': 1.5323, 'grad_norm': 2.3073461055755615, 'learning_rate': 9.377622377622378e-05, 'epoch': 1.24}
{'loss': 1.4735, 'grad_norm': 2.0362372398376465, 'learning_rate': 9.307692307692309e-05, 'epoch': 1.31}
{'loss': 1.4446, 'grad_norm': 2.368291139602661, 'learning_rate': 9.237762237762238e-05, 'epoch': 1.37}
{'loss': 1.4597, 'grad_norm': 2.4443633556365967, 'learning_rate': 9.167832167832169e-05, 'epoch': 1.44}
{'loss': 1.4095, 'grad_norm': 2.325087785720825, 'learning_rate': 9.097902097902098e-05, 'epoch': 1.51}
{'loss': 1.4818, 'grad_norm': 2.1797473430633545, 'learning_rate': 9.027972027972027e-05, 'epoch': 1.57}
{'loss': 1.4413, 'grad_norm': 2.316516160964966, 'learning_rate': 8.958041958041958e-05, 'epoch': 1.64}
{'loss': 1.4062, 'grad_norm': 2.396690607070923, 'learning_rate': 8.888111888111889e-05, 'epoch': 1.7}
{'loss': 1.3878, 'grad_norm': 2.4884703159332275, 'learning_rate': 8.818181818181818e-05, 'epoch': 1.77}
{'loss': 1.435, 'grad_norm': 2.4810569286346436, 'learning_rate': 8.755244755244755e-05, 'epoch': 1.83}
{'loss': 1.2993, 'grad_norm': 2.543851852416992, 'learning_rate': 8.685314685314686e-05, 'epoch': 1.9}
{'loss': 1.366, 'grad_norm': 2.6920342445373535, 'learning_rate': 8.615384615384617e-05, 'epoch': 1.97}
{'loss': 1.2936, 'grad_norm': 2.464128255844116, 'learning_rate': 8.545454545454545e-05, 'epoch': 2.03}
{'loss': 1.2238, 'grad_norm': 2.32523250579834, 'learning_rate': 8.475524475524476e-05, 'epoch': 2.09}
{'loss': 1.2138, 'grad_norm': 3.1685383319854736, 'learning_rate': 8.405594405594406e-05, 'epoch': 2.16}
{'loss': 1.289, 'grad_norm': 2.8248205184936523, 'learning_rate': 8.335664335664336e-05, 'epoch': 2.22}
{'loss': 1.1262, 'grad_norm': 3.136265516281128, 'learning_rate': 8.265734265734266e-05, 'epoch': 2.29}
{'loss': 1.1019, 'grad_norm': 2.3932337760925293, 'learning_rate': 8.195804195804197e-05, 'epoch': 2.35}
{'loss': 1.143, 'grad_norm': 3.0619499683380127, 'learning_rate': 8.125874125874126e-05, 'epoch': 2.42}
{'loss': 1.1, 'grad_norm': 2.814887762069702, 'learning_rate': 8.055944055944057e-05, 'epoch': 2.49}
{'loss': 1.2454, 'grad_norm': 2.80556321144104, 'learning_rate': 7.986013986013987e-05, 'epoch': 2.55}
{'loss': 1.0547, 'grad_norm': 3.0935091972351074, 'learning_rate': 7.916083916083916e-05, 'epoch': 2.62}
{'loss': 1.1121, 'grad_norm': 2.8366169929504395, 'learning_rate': 7.846153846153847e-05, 'epoch': 2.68}
{'loss': 1.072, 'grad_norm': 2.764202356338501, 'learning_rate': 7.776223776223776e-05, 'epoch': 2.75}
{'loss': 1.0598, 'grad_norm': 3.2547903060913086, 'learning_rate': 7.706293706293707e-05, 'epoch': 2.81}
{'loss': 1.0833, 'grad_norm': 3.1628966331481934, 'learning_rate': 7.636363636363637e-05, 'epoch': 2.88}
{'loss': 1.0721, 'grad_norm': 2.854438304901123, 'learning_rate': 7.566433566433567e-05, 'epoch': 2.95}
{'loss': 1.109, 'grad_norm': 2.784345865249634, 'learning_rate': 7.496503496503496e-05, 'epoch': 3.01}
{'loss': 0.9416, 'grad_norm': 3.2450473308563232, 'learning_rate': 7.426573426573427e-05, 'epoch': 3.07}
{'loss': 0.9093, 'grad_norm': 3.6760036945343018, 'learning_rate': 7.356643356643356e-05, 'epoch': 3.14}
{'loss': 0.887, 'grad_norm': 2.983281373977661, 'learning_rate': 7.286713286713287e-05, 'epoch': 3.2}
{'loss': 0.9106, 'grad_norm': 4.28073263168335, 'learning_rate': 7.216783216783218e-05, 'epoch': 3.27}
{'loss': 0.9236, 'grad_norm': 3.57175350189209, 'learning_rate': 7.146853146853147e-05, 'epoch': 3.33}
{'loss': 0.9209, 'grad_norm': 3.402907609939575, 'learning_rate': 7.076923076923078e-05, 'epoch': 3.4}
{'loss': 0.924, 'grad_norm': 2.8005728721618652, 'learning_rate': 7.006993006993008e-05, 'epoch': 3.47}
{'loss': 0.8222, 'grad_norm': 2.9163265228271484, 'learning_rate': 6.937062937062936e-05, 'epoch': 3.53}
{'loss': 0.916, 'grad_norm': 4.358963966369629, 'learning_rate': 6.867132867132867e-05, 'epoch': 3.6}
{'loss': 0.9269, 'grad_norm': 4.016955375671387, 'learning_rate': 6.797202797202798e-05, 'epoch': 3.66}
{'loss': 0.8855, 'grad_norm': 3.9334170818328857, 'learning_rate': 6.727272727272727e-05, 'epoch': 3.73}
{'loss': 0.851, 'grad_norm': 3.434267520904541, 'learning_rate': 6.657342657342658e-05, 'epoch': 3.79}
{'loss': 0.8599, 'grad_norm': 3.186950922012329, 'learning_rate': 6.587412587412587e-05, 'epoch': 3.86}
{'loss': 0.8182, 'grad_norm': 3.5901644229888916, 'learning_rate': 6.517482517482518e-05, 'epoch': 3.93}
{'loss': 0.8093, 'grad_norm': 2.713852882385254, 'learning_rate': 6.447552447552447e-05, 'epoch': 3.99}
{'loss': 0.7359, 'grad_norm': 3.9600985050201416, 'learning_rate': 6.377622377622378e-05, 'epoch': 4.05}
{'loss': 0.7219, 'grad_norm': 3.090595006942749, 'learning_rate': 6.307692307692308e-05, 'epoch': 4.12}
{'loss': 0.6794, 'grad_norm': 3.3581509590148926, 'learning_rate': 6.237762237762238e-05, 'epoch': 4.18}
{'loss': 0.7444, 'grad_norm': 3.312150239944458, 'learning_rate': 6.167832167832168e-05, 'epoch': 4.25}
{'loss': 0.7116, 'grad_norm': 3.6715469360351562, 'learning_rate': 6.0979020979020984e-05, 'epoch': 4.32}
{'loss': 0.7193, 'grad_norm': 3.0944762229919434, 'learning_rate': 6.0279720279720284e-05, 'epoch': 4.38}
{'loss': 0.7247, 'grad_norm': 3.8886656761169434, 'learning_rate': 5.958041958041959e-05, 'epoch': 4.45}
{'loss': 0.72, 'grad_norm': 4.152857303619385, 'learning_rate': 5.888111888111888e-05, 'epoch': 4.51}
{'loss': 0.6576, 'grad_norm': 3.577615737915039, 'learning_rate': 5.818181818181818e-05, 'epoch': 4.58}
{'loss': 0.685, 'grad_norm': 3.416938066482544, 'learning_rate': 5.7482517482517486e-05, 'epoch': 4.64}
{'loss': 0.6536, 'grad_norm': 3.236070156097412, 'learning_rate': 5.6783216783216786e-05, 'epoch': 4.71}
{'loss': 0.6667, 'grad_norm': 3.476834774017334, 'learning_rate': 5.608391608391609e-05, 'epoch': 4.78}
{'loss': 0.6663, 'grad_norm': 3.751004695892334, 'learning_rate': 5.538461538461539e-05, 'epoch': 4.84}
{'loss': 0.661, 'grad_norm': 3.388723373413086, 'learning_rate': 5.4685314685314694e-05, 'epoch': 4.91}
{'loss': 0.6248, 'grad_norm': 3.991860866546631, 'learning_rate': 5.398601398601398e-05, 'epoch': 4.97}
{'loss': 0.6183, 'grad_norm': 4.614623546600342, 'learning_rate': 5.328671328671329e-05, 'epoch': 5.03}
{'loss': 0.5388, 'grad_norm': 2.619175910949707, 'learning_rate': 5.258741258741259e-05, 'epoch': 5.1}
{'loss': 0.5425, 'grad_norm': 3.5453083515167236, 'learning_rate': 5.188811188811189e-05, 'epoch': 5.16}
{'loss': 0.5458, 'grad_norm': 3.637702465057373, 'learning_rate': 5.118881118881119e-05, 'epoch': 5.23}
{'loss': 0.5613, 'grad_norm': 3.386282444000244, 'learning_rate': 5.04895104895105e-05, 'epoch': 5.3}
{'loss': 0.5885, 'grad_norm': 3.9116086959838867, 'learning_rate': 4.979020979020979e-05, 'epoch': 5.36}
{'loss': 0.5515, 'grad_norm': 3.5097196102142334, 'learning_rate': 4.909090909090909e-05, 'epoch': 5.43}
{'loss': 0.5668, 'grad_norm': 3.7262721061706543, 'learning_rate': 4.83916083916084e-05, 'epoch': 5.49}
{'loss': 0.5383, 'grad_norm': 3.2728991508483887, 'learning_rate': 4.76923076923077e-05, 'epoch': 5.56}
{'loss': 0.519, 'grad_norm': 3.029519557952881, 'learning_rate': 4.699300699300699e-05, 'epoch': 5.62}
{'loss': 0.5385, 'grad_norm': 3.334700584411621, 'learning_rate': 4.629370629370629e-05, 'epoch': 5.69}
{'loss': 0.5244, 'grad_norm': 3.1341066360473633, 'learning_rate': 4.55944055944056e-05, 'epoch': 5.76}
{'loss': 0.5265, 'grad_norm': 3.0890307426452637, 'learning_rate': 4.4895104895104893e-05, 'epoch': 5.82}
{'loss': 0.5126, 'grad_norm': 3.077761650085449, 'learning_rate': 4.4195804195804194e-05, 'epoch': 5.89}
{'loss': 0.5036, 'grad_norm': 3.6097445487976074, 'learning_rate': 4.34965034965035e-05, 'epoch': 5.95}
{'loss': 0.4922, 'grad_norm': 3.5066421031951904, 'learning_rate': 4.27972027972028e-05, 'epoch': 6.01}
{'loss': 0.4519, 'grad_norm': 4.300576686859131, 'learning_rate': 4.2097902097902095e-05, 'epoch': 6.08}
{'loss': 0.4726, 'grad_norm': 3.5832977294921875, 'learning_rate': 4.13986013986014e-05, 'epoch': 6.14}
{'loss': 0.4528, 'grad_norm': 3.0919787883758545, 'learning_rate': 4.06993006993007e-05, 'epoch': 6.21}
{'loss': 0.4548, 'grad_norm': 3.250900983810425, 'learning_rate': 4e-05, 'epoch': 6.28}
{'loss': 0.449, 'grad_norm': 3.3147058486938477, 'learning_rate': 3.9300699300699304e-05, 'epoch': 6.34}
{'loss': 0.4223, 'grad_norm': 3.736887216567993, 'learning_rate': 3.8601398601398604e-05, 'epoch': 6.41}
{'loss': 0.4394, 'grad_norm': 2.663818120956421, 'learning_rate': 3.7902097902097905e-05, 'epoch': 6.47}
{'loss': 0.4483, 'grad_norm': 2.785870313644409, 'learning_rate': 3.7202797202797205e-05, 'epoch': 6.54}
{'loss': 0.4577, 'grad_norm': 3.6575422286987305, 'learning_rate': 3.6503496503496505e-05, 'epoch': 6.6}
{'loss': 0.43, 'grad_norm': 3.3369193077087402, 'learning_rate': 3.5804195804195806e-05, 'epoch': 6.67}
{'loss': 0.4342, 'grad_norm': 2.9554266929626465, 'learning_rate': 3.5104895104895106e-05, 'epoch': 6.74}
{'loss': 0.4291, 'grad_norm': 2.5284264087677, 'learning_rate': 3.440559440559441e-05, 'epoch': 6.8}
{'loss': 0.4138, 'grad_norm': 3.5360097885131836, 'learning_rate': 3.370629370629371e-05, 'epoch': 6.87}
{'loss': 0.4101, 'grad_norm': 2.9829113483428955, 'learning_rate': 3.300699300699301e-05, 'epoch': 6.93}
{'loss': 0.4369, 'grad_norm': 3.4280664920806885, 'learning_rate': 3.230769230769231e-05, 'epoch': 7.0}
{'loss': 0.3838, 'grad_norm': 2.4244649410247803, 'learning_rate': 3.160839160839161e-05, 'epoch': 7.06}
{'loss': 0.3791, 'grad_norm': 2.353250026702881, 'learning_rate': 3.090909090909091e-05, 'epoch': 7.12}
{'loss': 0.3852, 'grad_norm': 2.7060458660125732, 'learning_rate': 3.0209790209790213e-05, 'epoch': 7.19}
{'loss': 0.3727, 'grad_norm': 2.7092928886413574, 'learning_rate': 2.9510489510489513e-05, 'epoch': 7.26}
{'loss': 0.3814, 'grad_norm': 3.267364263534546, 'learning_rate': 2.881118881118881e-05, 'epoch': 7.32}
{'loss': 0.3618, 'grad_norm': 3.0176289081573486, 'learning_rate': 2.8111888111888114e-05, 'epoch': 7.39}
{'loss': 0.3753, 'grad_norm': 2.8400039672851562, 'learning_rate': 2.7412587412587414e-05, 'epoch': 7.45}
{'loss': 0.3943, 'grad_norm': 3.0334312915802, 'learning_rate': 2.6713286713286718e-05, 'epoch': 7.52}
{'loss': 0.3768, 'grad_norm': 2.9335269927978516, 'learning_rate': 2.6013986013986015e-05, 'epoch': 7.58}
{'loss': 0.3696, 'grad_norm': 2.3296267986297607, 'learning_rate': 2.5314685314685316e-05, 'epoch': 7.65}
{'loss': 0.3521, 'grad_norm': 2.459655284881592, 'learning_rate': 2.461538461538462e-05, 'epoch': 7.72}
{'loss': 0.3725, 'grad_norm': 2.582252264022827, 'learning_rate': 2.3916083916083917e-05, 'epoch': 7.78}
{'loss': 0.3543, 'grad_norm': 2.198718786239624, 'learning_rate': 2.3216783216783217e-05, 'epoch': 7.85}
{'loss': 0.3765, 'grad_norm': 2.413299560546875, 'learning_rate': 2.2517482517482517e-05, 'epoch': 7.91}
{'loss': 0.3638, 'grad_norm': 3.134596824645996, 'learning_rate': 2.1818181818181818e-05, 'epoch': 7.98}
{'loss': 0.3511, 'grad_norm': 2.299811840057373, 'learning_rate': 2.111888111888112e-05, 'epoch': 8.04}
{'loss': 0.3247, 'grad_norm': 4.16349983215332, 'learning_rate': 2.041958041958042e-05, 'epoch': 8.11}
{'loss': 0.3285, 'grad_norm': 2.3262434005737305, 'learning_rate': 1.9720279720279722e-05, 'epoch': 8.17}
{'loss': 0.3468, 'grad_norm': 2.4117836952209473, 'learning_rate': 1.902097902097902e-05, 'epoch': 8.24}
{'loss': 0.3362, 'grad_norm': 2.1141159534454346, 'learning_rate': 1.8321678321678323e-05, 'epoch': 8.3}
{'loss': 0.3324, 'grad_norm': 3.933600425720215, 'learning_rate': 1.7622377622377624e-05, 'epoch': 8.37}
{'loss': 0.3364, 'grad_norm': 2.1624600887298584, 'learning_rate': 1.6923076923076924e-05, 'epoch': 8.43}
{'loss': 0.3244, 'grad_norm': 1.9645620584487915, 'learning_rate': 1.6223776223776225e-05, 'epoch': 8.5}
{'loss': 0.3247, 'grad_norm': 2.109250068664551, 'learning_rate': 1.5524475524475525e-05, 'epoch': 8.56}
{'loss': 0.334, 'grad_norm': 2.0096514225006104, 'learning_rate': 1.4825174825174825e-05, 'epoch': 8.63}
{'loss': 0.3343, 'grad_norm': 2.0238704681396484, 'learning_rate': 1.4125874125874128e-05, 'epoch': 8.7}
{'loss': 0.3153, 'grad_norm': 2.3058676719665527, 'learning_rate': 1.3426573426573428e-05, 'epoch': 8.76}
{'loss': 0.3373, 'grad_norm': 3.2053260803222656, 'learning_rate': 1.2727272727272727e-05, 'epoch': 8.83}
{'loss': 0.3221, 'grad_norm': 2.2915210723876953, 'learning_rate': 1.2027972027972029e-05, 'epoch': 8.89}
{'loss': 0.3194, 'grad_norm': 2.413278579711914, 'learning_rate': 1.132867132867133e-05, 'epoch': 8.96}
{'loss': 0.332, 'grad_norm': 1.777875304222107, 'learning_rate': 1.062937062937063e-05, 'epoch': 9.02}
{'loss': 0.3087, 'grad_norm': 2.4704432487487793, 'learning_rate': 9.93006993006993e-06, 'epoch': 9.09}
{'loss': 0.3104, 'grad_norm': 1.5432014465332031, 'learning_rate': 9.230769230769232e-06, 'epoch': 9.15}
{'loss': 0.3146, 'grad_norm': 1.7993284463882446, 'learning_rate': 8.531468531468533e-06, 'epoch': 9.22}
{'loss': 0.3138, 'grad_norm': 1.6565628051757812, 'learning_rate': 7.832167832167833e-06, 'epoch': 9.28}
{'loss': 0.3094, 'grad_norm': 1.6446541547775269, 'learning_rate': 7.132867132867133e-06, 'epoch': 9.35}
{'loss': 0.3001, 'grad_norm': 2.0454533100128174, 'learning_rate': 6.433566433566433e-06, 'epoch': 9.41}
{'loss': 0.3003, 'grad_norm': 1.7650526762008667, 'learning_rate': 5.7342657342657345e-06, 'epoch': 9.48}
{'loss': 0.3053, 'grad_norm': 1.5294396877288818, 'learning_rate': 5.034965034965036e-06, 'epoch': 9.55}
{'loss': 0.3113, 'grad_norm': 1.8014049530029297, 'learning_rate': 4.335664335664335e-06, 'epoch': 9.61}
{'loss': 0.3127, 'grad_norm': 1.6457898616790771, 'learning_rate': 3.636363636363636e-06, 'epoch': 9.68}
{'loss': 0.3032, 'grad_norm': 1.6520769596099854, 'learning_rate': 2.937062937062937e-06, 'epoch': 9.74}
{'loss': 0.3161, 'grad_norm': 1.6000727415084839, 'learning_rate': 2.237762237762238e-06, 'epoch': 9.81}
{'loss': 0.2997, 'grad_norm': 1.6557645797729492, 'learning_rate': 1.5384615384615387e-06, 'epoch': 9.87}
{'loss': 0.3028, 'grad_norm': 4.0945587158203125, 'learning_rate': 8.391608391608393e-07, 'epoch': 9.94}
{'loss': 0.2951, 'grad_norm': 3.402771234512329, 'learning_rate': 1.3986013986013987e-07, 'epoch': 10.0}
{'train_runtime': 2565.7157, 'train_samples_per_second': 4.747, 'train_steps_per_second': 0.596, 'train_loss': 0.8455305227267197, 'epoch': 10.0}
Saving model to ./qwen_law_assistant...
Fine-tuning completed!
Fine-tuning completed! Model saved to: ./qwen_law_assistant

=== Pipeline completed! ===
