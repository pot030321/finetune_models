  0%|                                                                                                                                                             | 0/1530 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
                                                                                                                                                                                           
{'loss': 3.9003, 'grad_norm': 5.146732330322266, 'learning_rate': 9e-06, 'epoch': 0.07}
{'loss': 3.6331, 'grad_norm': 3.5101981163024902, 'learning_rate': 1.9e-05, 'epoch': 0.13}
{'loss': 3.3125, 'grad_norm': 3.1672799587249756, 'learning_rate': 2.9e-05, 'epoch': 0.2}
{'loss': 3.0067, 'grad_norm': 2.6271746158599854, 'learning_rate': 3.9000000000000006e-05, 'epoch': 0.26}
{'loss': 2.6947, 'grad_norm': 2.5100083351135254, 'learning_rate': 4.9e-05, 'epoch': 0.33}
{'loss': 2.4846, 'grad_norm': 2.870652198791504, 'learning_rate': 5.9e-05, 'epoch': 0.39}
{'loss': 2.4438, 'grad_norm': 2.1130690574645996, 'learning_rate': 6.9e-05, 'epoch': 0.46}
{'loss': 2.372, 'grad_norm': 2.2635834217071533, 'learning_rate': 7.900000000000001e-05, 'epoch': 0.53}
{'loss': 2.255, 'grad_norm': 2.300220251083374, 'learning_rate': 8.900000000000001e-05, 'epoch': 0.59}
{'loss': 2.1345, 'grad_norm': 2.5575718879699707, 'learning_rate': 9.900000000000001e-05, 'epoch': 0.66}
{'loss': 2.0798, 'grad_norm': 3.597154140472412, 'learning_rate': 9.937062937062938e-05, 'epoch': 0.72}
{'loss': 1.9909, 'grad_norm': 3.142085313796997, 'learning_rate': 9.867132867132868e-05, 'epoch': 0.79}
{'loss': 1.9647, 'grad_norm': 2.552130699157715, 'learning_rate': 9.797202797202798e-05, 'epoch': 0.85}
{'loss': 1.9451, 'grad_norm': 2.224980115890503, 'learning_rate': 9.727272727272728e-05, 'epoch': 0.92}
{'loss': 1.8795, 'grad_norm': 2.4293978214263916, 'learning_rate': 9.657342657342658e-05, 'epoch': 0.99}
{'loss': 1.8561, 'grad_norm': 2.5403432846069336, 'learning_rate': 9.587412587412587e-05, 'epoch': 1.05}
{'loss': 1.72, 'grad_norm': 2.20275616645813, 'learning_rate': 9.517482517482518e-05, 'epoch': 1.11}
{'loss': 1.7948, 'grad_norm': 2.502974033355713, 'learning_rate': 9.447552447552449e-05, 'epoch': 1.18}
{'loss': 1.7386, 'grad_norm': 2.5310537815093994, 'learning_rate': 9.377622377622378e-05, 'epoch': 1.24}
{'loss': 1.6603, 'grad_norm': 2.344693183898926, 'learning_rate': 9.307692307692309e-05, 'epoch': 1.31}
{'loss': 1.6241, 'grad_norm': 2.7715702056884766, 'learning_rate': 9.237762237762238e-05, 'epoch': 1.37}
{'loss': 1.6548, 'grad_norm': 2.6881103515625, 'learning_rate': 9.167832167832169e-05, 'epoch': 1.44}
{'loss': 1.5822, 'grad_norm': 2.6740713119506836, 'learning_rate': 9.097902097902098e-05, 'epoch': 1.51}
{'loss': 1.6697, 'grad_norm': 2.4285728931427, 'learning_rate': 9.027972027972027e-05, 'epoch': 1.57}
{'loss': 1.6285, 'grad_norm': 2.6634278297424316, 'learning_rate': 8.958041958041958e-05, 'epoch': 1.64}
{'loss': 1.5762, 'grad_norm': 2.4945790767669678, 'learning_rate': 8.888111888111889e-05, 'epoch': 1.7}
{'loss': 1.5614, 'grad_norm': 2.8482675552368164, 'learning_rate': 8.818181818181818e-05, 'epoch': 1.77}
{'loss': 1.6265, 'grad_norm': 2.865419387817383, 'learning_rate': 8.748251748251749e-05, 'epoch': 1.83}
{'loss': 1.4593, 'grad_norm': 2.745459794998169, 'learning_rate': 8.67832167832168e-05, 'epoch': 1.9}
{'loss': 1.5376, 'grad_norm': 3.0078282356262207, 'learning_rate': 8.608391608391608e-05, 'epoch': 1.97}
{'loss': 1.4601, 'grad_norm': 2.8536956310272217, 'learning_rate': 8.545454545454545e-05, 'epoch': 2.03}
{'loss': 1.3786, 'grad_norm': 2.465660572052002, 'learning_rate': 8.475524475524476e-05, 'epoch': 2.09}
{'loss': 1.3665, 'grad_norm': 3.8194739818573, 'learning_rate': 8.405594405594406e-05, 'epoch': 2.16}
{'loss': 1.4568, 'grad_norm': 3.2551932334899902, 'learning_rate': 8.335664335664336e-05, 'epoch': 2.22}
{'loss': 1.2606, 'grad_norm': 3.5091896057128906, 'learning_rate': 8.265734265734266e-05, 'epoch': 2.29}
{'loss': 1.2344, 'grad_norm': 2.6846423149108887, 'learning_rate': 8.195804195804197e-05, 'epoch': 2.35}
{'loss': 1.2822, 'grad_norm': 3.4677765369415283, 'learning_rate': 8.125874125874126e-05, 'epoch': 2.42}
{'loss': 1.2468, 'grad_norm': 3.1506540775299072, 'learning_rate': 8.055944055944057e-05, 'epoch': 2.49}
{'loss': 1.3966, 'grad_norm': 3.0675039291381836, 'learning_rate': 7.986013986013987e-05, 'epoch': 2.55}
{'loss': 1.1905, 'grad_norm': 3.1745505332946777, 'learning_rate': 7.916083916083916e-05, 'epoch': 2.62}
{'loss': 1.2505, 'grad_norm': 2.763823986053467, 'learning_rate': 7.846153846153847e-05, 'epoch': 2.68}
{'loss': 1.2138, 'grad_norm': 3.0617167949676514, 'learning_rate': 7.776223776223776e-05, 'epoch': 2.75}
{'loss': 1.1956, 'grad_norm': 3.3801355361938477, 'learning_rate': 7.706293706293707e-05, 'epoch': 2.81}
{'loss': 1.2247, 'grad_norm': 3.2757630348205566, 'learning_rate': 7.636363636363637e-05, 'epoch': 2.88}
{'loss': 1.2011, 'grad_norm': 3.6076009273529053, 'learning_rate': 7.566433566433567e-05, 'epoch': 2.95}
{'loss': 1.2549, 'grad_norm': 3.2829761505126953, 'learning_rate': 7.496503496503496e-05, 'epoch': 3.01}
{'loss': 1.0638, 'grad_norm': 3.101189613342285, 'learning_rate': 7.426573426573427e-05, 'epoch': 3.07}
{'loss': 1.0316, 'grad_norm': 4.656224250793457, 'learning_rate': 7.356643356643356e-05, 'epoch': 3.14}
{'loss': 0.9951, 'grad_norm': 3.277859687805176, 'learning_rate': 7.286713286713287e-05, 'epoch': 3.2}
{'loss': 1.025, 'grad_norm': 4.03169059753418, 'learning_rate': 7.216783216783218e-05, 'epoch': 3.27}
{'loss': 1.027, 'grad_norm': 4.154434680938721, 'learning_rate': 7.146853146853147e-05, 'epoch': 3.33}
{'loss': 1.0372, 'grad_norm': 4.434614181518555, 'learning_rate': 7.076923076923078e-05, 'epoch': 3.4}
{'loss': 1.0357, 'grad_norm': 3.0743420124053955, 'learning_rate': 7.006993006993008e-05, 'epoch': 3.47}
{'loss': 0.9298, 'grad_norm': 3.1033968925476074, 'learning_rate': 6.937062937062936e-05, 'epoch': 3.53}
{'loss': 1.0388, 'grad_norm': 4.700549125671387, 'learning_rate': 6.867132867132867e-05, 'epoch': 3.6}
{'loss': 1.0515, 'grad_norm': 4.3878278732299805, 'learning_rate': 6.797202797202798e-05, 'epoch': 3.66}
{'loss': 0.9991, 'grad_norm': 4.3676629066467285, 'learning_rate': 6.727272727272727e-05, 'epoch': 3.73}
{'loss': 0.9583, 'grad_norm': 4.016391754150391, 'learning_rate': 6.657342657342658e-05, 'epoch': 3.79}
{'loss': 0.963, 'grad_norm': 3.4539988040924072, 'learning_rate': 6.587412587412587e-05, 'epoch': 3.86}
{'loss': 0.9205, 'grad_norm': 3.756254196166992, 'learning_rate': 6.517482517482518e-05, 'epoch': 3.93}
{'loss': 0.8986, 'grad_norm': 3.1834700107574463, 'learning_rate': 6.447552447552447e-05, 'epoch': 3.99}
{'loss': 0.8213, 'grad_norm': 4.117799758911133, 'learning_rate': 6.377622377622378e-05, 'epoch': 4.05}
{'loss': 0.8154, 'grad_norm': 3.7641329765319824, 'learning_rate': 6.307692307692308e-05, 'epoch': 4.12}
{'loss': 0.7627, 'grad_norm': 3.695070743560791, 'learning_rate': 6.237762237762238e-05, 'epoch': 4.18}
{'loss': 0.8373, 'grad_norm': 3.4196157455444336, 'learning_rate': 6.167832167832168e-05, 'epoch': 4.25}
{'loss': 0.7995, 'grad_norm': 3.979015350341797, 'learning_rate': 6.0979020979020984e-05, 'epoch': 4.32}
{'loss': 0.8118, 'grad_norm': 3.2589592933654785, 'learning_rate': 6.0279720279720284e-05, 'epoch': 4.38}
{'loss': 0.8183, 'grad_norm': 4.419666290283203, 'learning_rate': 5.958041958041959e-05, 'epoch': 4.45}
{'loss': 0.8162, 'grad_norm': 4.675370693206787, 'learning_rate': 5.888111888111888e-05, 'epoch': 4.51}
{'loss': 0.7374, 'grad_norm': 3.836172103881836, 'learning_rate': 5.818181818181818e-05, 'epoch': 4.58}
{'loss': 0.7627, 'grad_norm': 3.9617035388946533, 'learning_rate': 5.7482517482517486e-05, 'epoch': 4.64}
{'loss': 0.7349, 'grad_norm': 3.724229335784912, 'learning_rate': 5.6783216783216786e-05, 'epoch': 4.71}
{'loss': 0.7577, 'grad_norm': 4.408318996429443, 'learning_rate': 5.608391608391609e-05, 'epoch': 4.78}
{'loss': 0.7316, 'grad_norm': 3.403278350830078, 'learning_rate': 5.538461538461539e-05, 'epoch': 4.84}
{'loss': 0.7469, 'grad_norm': 4.04815673828125, 'learning_rate': 5.4685314685314694e-05, 'epoch': 4.91}
{'loss': 0.7094, 'grad_norm': 4.550411701202393, 'learning_rate': 5.398601398601398e-05, 'epoch': 4.97}
{'loss': 0.7008, 'grad_norm': 4.6158366203308105, 'learning_rate': 5.328671328671329e-05, 'epoch': 5.03}
{'loss': 0.611, 'grad_norm': 3.0177078247070312, 'learning_rate': 5.258741258741259e-05, 'epoch': 5.1}
{'loss': 0.6166, 'grad_norm': 3.9688632488250732, 'learning_rate': 5.188811188811189e-05, 'epoch': 5.16}
{'loss': 0.6104, 'grad_norm': 3.8660073280334473, 'learning_rate': 5.118881118881119e-05, 'epoch': 5.23}
{'loss': 0.6282, 'grad_norm': 3.494858741760254, 'learning_rate': 5.04895104895105e-05, 'epoch': 5.3}
{'loss': 0.6717, 'grad_norm': 4.064347743988037, 'learning_rate': 4.979020979020979e-05, 'epoch': 5.36}
{'loss': 0.616, 'grad_norm': 3.9731462001800537, 'learning_rate': 4.909090909090909e-05, 'epoch': 5.43}
{'loss': 0.6382, 'grad_norm': 3.5812911987304688, 'learning_rate': 4.83916083916084e-05, 'epoch': 5.49}
{'loss': 0.603, 'grad_norm': 4.125349998474121, 'learning_rate': 4.76923076923077e-05, 'epoch': 5.56}
{'loss': 0.5852, 'grad_norm': 3.039613723754883, 'learning_rate': 4.699300699300699e-05, 'epoch': 5.62}
{'loss': 0.6108, 'grad_norm': 4.2481536865234375, 'learning_rate': 4.629370629370629e-05, 'epoch': 5.69}
{'loss': 0.5868, 'grad_norm': 3.449308156967163, 'learning_rate': 4.55944055944056e-05, 'epoch': 5.76}
{'loss': 0.5859, 'grad_norm': 3.729182720184326, 'learning_rate': 4.4895104895104893e-05, 'epoch': 5.82}
{'loss': 0.5672, 'grad_norm': 3.4254584312438965, 'learning_rate': 4.4195804195804194e-05, 'epoch': 5.89}
{'loss': 0.5611, 'grad_norm': 4.578293800354004, 'learning_rate': 4.34965034965035e-05, 'epoch': 5.95}
{'loss': 0.5427, 'grad_norm': 3.224820852279663, 'learning_rate': 4.27972027972028e-05, 'epoch': 6.01}
{'loss': 0.5102, 'grad_norm': 4.1733551025390625, 'learning_rate': 4.2097902097902095e-05, 'epoch': 6.08}
{'loss': 0.535, 'grad_norm': 4.130268096923828, 'learning_rate': 4.13986013986014e-05, 'epoch': 6.14}
{'loss': 0.5062, 'grad_norm': 3.1300172805786133, 'learning_rate': 4.06993006993007e-05, 'epoch': 6.21}
{'loss': 0.5106, 'grad_norm': 3.833671808242798, 'learning_rate': 4e-05, 'epoch': 6.28}
{'loss': 0.5081, 'grad_norm': 3.4624481201171875, 'learning_rate': 3.9300699300699304e-05, 'epoch': 6.34}
{'loss': 0.4761, 'grad_norm': 3.948679208755493, 'learning_rate': 3.8601398601398604e-05, 'epoch': 6.41}
{'loss': 0.4899, 'grad_norm': 3.259981632232666, 'learning_rate': 3.7902097902097905e-05, 'epoch': 6.47}
{'loss': 0.5034, 'grad_norm': 3.177008867263794, 'learning_rate': 3.7202797202797205e-05, 'epoch': 6.54}
{'loss': 0.5185, 'grad_norm': 5.407313823699951, 'learning_rate': 3.6503496503496505e-05, 'epoch': 6.6}
{'loss': 0.4751, 'grad_norm': 4.083888053894043, 'learning_rate': 3.5804195804195806e-05, 'epoch': 6.67}
{'loss': 0.4804, 'grad_norm': 3.732977867126465, 'learning_rate': 3.5104895104895106e-05, 'epoch': 6.74}
{'loss': 0.4828, 'grad_norm': 2.919768810272217, 'learning_rate': 3.440559440559441e-05, 'epoch': 6.8}
{'loss': 0.4703, 'grad_norm': 3.8423943519592285, 'learning_rate': 3.370629370629371e-05, 'epoch': 6.87}
{'loss': 0.4595, 'grad_norm': 3.6261141300201416, 'learning_rate': 3.300699300699301e-05, 'epoch': 6.93}
{'loss': 0.483, 'grad_norm': 4.024627208709717, 'learning_rate': 3.230769230769231e-05, 'epoch': 7.0}
{'loss': 0.4284, 'grad_norm': 2.9232287406921387, 'learning_rate': 3.160839160839161e-05, 'epoch': 7.06}
{'loss': 0.429, 'grad_norm': 2.6041462421417236, 'learning_rate': 3.090909090909091e-05, 'epoch': 7.12}
{'loss': 0.4291, 'grad_norm': 3.4086174964904785, 'learning_rate': 3.0209790209790213e-05, 'epoch': 7.19}
{'loss': 0.4203, 'grad_norm': 3.378826141357422, 'learning_rate': 2.9510489510489513e-05, 'epoch': 7.26}
{'loss': 0.436, 'grad_norm': 2.828765869140625, 'learning_rate': 2.881118881118881e-05, 'epoch': 7.32}
{'loss': 0.401, 'grad_norm': 2.974931478500366, 'learning_rate': 2.8111888111888114e-05, 'epoch': 7.39}
{'loss': 0.424, 'grad_norm': 3.029693126678467, 'learning_rate': 2.7412587412587414e-05, 'epoch': 7.45}
{'loss': 0.4408, 'grad_norm': 3.6727707386016846, 'learning_rate': 2.6713286713286718e-05, 'epoch': 7.52}
{'loss': 0.4204, 'grad_norm': 3.18623948097229, 'learning_rate': 2.6013986013986015e-05, 'epoch': 7.58}
{'loss': 0.4136, 'grad_norm': 2.3350272178649902, 'learning_rate': 2.5314685314685316e-05, 'epoch': 7.65}
{'loss': 0.3933, 'grad_norm': 3.966324806213379, 'learning_rate': 2.461538461538462e-05, 'epoch': 7.72}
{'loss': 0.4153, 'grad_norm': 2.567222833633423, 'learning_rate': 2.3916083916083917e-05, 'epoch': 7.78}
{'loss': 0.3916, 'grad_norm': 2.561410903930664, 'learning_rate': 2.3216783216783217e-05, 'epoch': 7.85}
{'loss': 0.4224, 'grad_norm': 2.870041847229004, 'learning_rate': 2.2517482517482517e-05, 'epoch': 7.91}
{'loss': 0.4066, 'grad_norm': 3.0783262252807617, 'learning_rate': 2.1818181818181818e-05, 'epoch': 7.98}
{'loss': 0.3982, 'grad_norm': 2.3653879165649414, 'learning_rate': 2.111888111888112e-05, 'epoch': 8.04}
{'loss': 0.3591, 'grad_norm': 3.279130220413208, 'learning_rate': 2.041958041958042e-05, 'epoch': 8.11}
{'loss': 0.3703, 'grad_norm': 2.8369054794311523, 'learning_rate': 1.9720279720279722e-05, 'epoch': 8.17}
{'loss': 0.3915, 'grad_norm': 2.272644281387329, 'learning_rate': 1.902097902097902e-05, 'epoch': 8.24}
{'loss': 0.3725, 'grad_norm': 2.8159854412078857, 'learning_rate': 1.8321678321678323e-05, 'epoch': 8.3}
{'loss': 0.372, 'grad_norm': 2.3222694396972656, 'learning_rate': 1.7622377622377624e-05, 'epoch': 8.37}
{'loss': 0.3792, 'grad_norm': 3.0169436931610107, 'learning_rate': 1.6923076923076924e-05, 'epoch': 8.43}
{'loss': 0.3629, 'grad_norm': 2.087728500366211, 'learning_rate': 1.6223776223776225e-05, 'epoch': 8.5}
{'loss': 0.3675, 'grad_norm': 3.202558994293213, 'learning_rate': 1.5524475524475525e-05, 'epoch': 8.56}
{'loss': 0.3718, 'grad_norm': 2.1274802684783936, 'learning_rate': 1.4825174825174825e-05, 'epoch': 8.63}
{'loss': 0.3734, 'grad_norm': 2.7667646408081055, 'learning_rate': 1.4125874125874128e-05, 'epoch': 8.7}
{'loss': 0.3479, 'grad_norm': 1.9424089193344116, 'learning_rate': 1.3426573426573428e-05, 'epoch': 8.76}
{'loss': 0.3762, 'grad_norm': 2.531047821044922, 'learning_rate': 1.2727272727272727e-05, 'epoch': 8.83}
{'loss': 0.3624, 'grad_norm': 2.474808692932129, 'learning_rate': 1.2027972027972029e-05, 'epoch': 8.89}
{'loss': 0.3563, 'grad_norm': 2.7224230766296387, 'learning_rate': 1.132867132867133e-05, 'epoch': 8.96}
  warnings.warn(
C:\Users\ADMIN\AppData\Local\Programs\Python\Python312\Lib\site-packages\peft\utils\save_and_load.py:286: UserWarning: Could not find a config file in Qwen/Qwen2.5-0.5B - will assume that the vocabulary was not modified.
  warnings.warn(
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1530/1530 [40:33<00:00,  1.59s/it]
{'loss': 0.3666, 'grad_norm': 2.010012626647949, 'learning_rate': 1.062937062937063e-05, 'epoch': 9.02}
{'loss': 0.3466, 'grad_norm': 2.2260634899139404, 'learning_rate': 9.93006993006993e-06, 'epoch': 9.09}
{'loss': 0.3463, 'grad_norm': 1.871535301208496, 'learning_rate': 9.230769230769232e-06, 'epoch': 9.15}
{'loss': 0.3529, 'grad_norm': 2.727234363555908, 'learning_rate': 8.531468531468533e-06, 'epoch': 9.22}
{'loss': 0.3521, 'grad_norm': 2.114560127258301, 'learning_rate': 7.832167832167833e-06, 'epoch': 9.28}
{'loss': 0.3443, 'grad_norm': 1.8763184547424316, 'learning_rate': 7.132867132867133e-06, 'epoch': 9.35}
{'loss': 0.3336, 'grad_norm': 2.043182134628296, 'learning_rate': 6.433566433566433e-06, 'epoch': 9.41}
{'loss': 0.3343, 'grad_norm': 2.1649093627929688, 'learning_rate': 5.7342657342657345e-06, 'epoch': 9.48}
{'loss': 0.3359, 'grad_norm': 1.5959725379943848, 'learning_rate': 5.034965034965036e-06, 'epoch': 9.55}
{'loss': 0.3458, 'grad_norm': 2.0803565979003906, 'learning_rate': 4.335664335664335e-06, 'epoch': 9.61}
{'loss': 0.3502, 'grad_norm': 1.5106475353240967, 'learning_rate': 3.636363636363636e-06, 'epoch': 9.68}
{'loss': 0.338, 'grad_norm': 1.7351983785629272, 'learning_rate': 2.937062937062937e-06, 'epoch': 9.74}
{'loss': 0.3508, 'grad_norm': 1.9356361627578735, 'learning_rate': 2.237762237762238e-06, 'epoch': 9.81}
{'loss': 0.3366, 'grad_norm': 1.9872686862945557, 'learning_rate': 1.5384615384615387e-06, 'epoch': 9.87}
{'loss': 0.3373, 'grad_norm': 2.39919376373291, 'learning_rate': 8.391608391608393e-07, 'epoch': 9.94}
{'loss': 0.3299, 'grad_norm': 3.32537579536438, 'learning_rate': 1.3986013986013987e-07, 'epoch': 10.0}
{'train_runtime': 2435.3136, 'train_samples_per_second': 5.001, 'train_steps_per_second': 0.628, 'train_loss': 0.9445669323790307, 'epoch': 10.0}
Saving model to ./qwen_law_assistant...
Fine-tuning completed!
Fine-tuning completed! Model saved to: ./qwen_law_assistant

=== Pipeline completed! ===
